import{s as se,f as g,a as A,g as k,h as w,c as K,r as G,d as v,j as b,i as j,u as p,K as X,x as U,N as ie,y as ce,v as Y,z as ue,H as fe,o as ae,l as de,m as _e,w as z,n as he,B as me,A as M,p as Z,D as pe,E as be,F as ve,G as ge}from"../chunks/scheduler.bed694a1.js";import{S as ne,i as re,g as ke,t as T,c as ye,a as I,j as Ee,b as O,d as R,m as J,e as Q}from"../chunks/index.606d5641.js";import{e as x}from"../chunks/each.177d9825.js";import{f as Se}from"../chunks/index.35d92de3.js";import{p as we}from"../chunks/stores.d5b6ea7f.js";import{s as ee}from"../chunks/state.88bbaa31.js";import{t as De}from"../chunks/table.6d6102f7.js";import{I as oe}from"../chunks/Icon.62ba3e81.js";function te(i,e,t){const r=i.slice();return r[15]=e[t],r[17]=t,r}function Ie(i){let e,t,r;return t=new oe({props:{icon:"search"}}),{c(){e=g("i"),O(t.$$.fragment),this.h()},l(o){e=k(o,"I",{class:!0});var s=w(e);R(t.$$.fragment,s),s.forEach(v),this.h()},h(){b(e,"class","svelte-e64a3l")},m(o,s){j(o,e,s),J(t,e,null),r=!0},p:M,i(o){r||(I(t.$$.fragment,o),r=!0)},o(o){T(t.$$.fragment,o),r=!1},d(o){o&&v(e),Q(t)}}}function Ce(i){let e,t,r="Reset filter",o,s,d,l,a;return s=new oe({props:{icon:"x"}}),{c(){e=g("button"),t=g("span"),t.textContent=r,o=A(),O(s.$$.fragment),this.h()},l(n){e=k(n,"BUTTON",{class:!0});var m=w(e);t=k(m,"SPAN",{class:!0,"data-svelte-h":!0}),G(t)!=="svelte-8g7ehw"&&(t.textContent=r),o=K(m),R(s.$$.fragment,m),m.forEach(v),this.h()},h(){b(t,"class","label"),b(e,"class","svelte-e64a3l")},m(n,m){j(n,e,m),p(e,t),p(e,o),J(s,e,null),d=!0,l||(a=U(e,"click",i[8]),l=!0)},p:M,i(n){d||(I(s.$$.fragment,n),d=!0)},o(n){T(s.$$.fragment,n),d=!1},d(n){n&&v(e),Q(s),l=!1,a()}}}function le(i){let e,t,r=i[15].name+"",o,s,d,l;return{c(){e=g("li"),t=g("a"),o=de(r),d=A(),this.h()},l(a){e=k(a,"LI",{});var n=w(e);t=k(n,"A",{href:!0,class:!0});var m=w(t);o=_e(m,r),m.forEach(v),d=K(n),n.forEach(v),this.h()},h(){b(t,"href",s="/database/table/"+i[15].id),b(t,"class","svelte-e64a3l"),z(t,"active",i[15].id===i[4].params.id)},m(a,n){j(a,e,n),p(e,t),p(t,o),p(e,d)},p(a,n){n&1&&r!==(r=a[15].name+"")&&he(o,r),n&1&&s!==(s="/database/table/"+a[15].id)&&b(t,"href",s),n&17&&z(t,"active",a[15].id===a[4].params.id)},i(a){a&&(l||me(()=>{l=Ee(e,Se,{duration:100,delay:7*i[17]}),l.start()}))},o:M,d(a){a&&v(e)}}}function $e(i){let e,t,r,o,s,d,l,a,n,m="Ctrl",E,P="K",V,C,$,q,H,c;const L=[Ce,Ie],S=[];function B(u,h){return u[3]?0:1}o=B(i),s=S[o]=L[o](i);let D=x(i[0]),_=[];for(let u=0;u<D.length;u+=1)_[u]=le(te(i,D,u));return{c(){e=g("aside"),t=g("div"),r=g("div"),s.c(),d=A(),l=g("input"),a=A(),n=g("kbd"),n.textContent=m,E=g("kbd"),E.textContent=P,V=A(),C=g("nav"),$=g("ul");for(let u=0;u<_.length;u+=1)_[u].c();this.h()},l(u){e=k(u,"ASIDE",{class:!0});var h=w(e);t=k(h,"DIV",{class:!0});var y=w(t);r=k(y,"DIV",{class:!0});var f=w(r);s.l(f),d=K(f),l=k(f,"INPUT",{type:!0,placeholder:!0,class:!0}),a=K(f),n=k(f,"KBD",{class:!0,"data-svelte-h":!0}),G(n)!=="svelte-1c7qffr"&&(n.textContent=m),E=k(f,"KBD",{class:!0,"data-svelte-h":!0}),G(E)!=="svelte-3k5xuj"&&(E.textContent=P),f.forEach(v),y.forEach(v),V=K(h),C=k(h,"NAV",{class:!0});var N=w(C);$=k(N,"UL",{});var W=w($);for(let F=0;F<_.length;F+=1)_[F].l(W);W.forEach(v),N.forEach(v),h.forEach(v),this.h()},h(){b(l,"type","text"),b(l,"placeholder","Search tables"),b(l,"class","svelte-e64a3l"),b(n,"class","svelte-e64a3l"),b(E,"class","svelte-e64a3l"),b(r,"class","filter svelte-e64a3l"),b(t,"class","filter-container svelte-e64a3l"),b(C,"class","svelte-e64a3l"),b(e,"class","svelte-e64a3l")},m(u,h){j(u,e,h),p(e,t),p(t,r),S[o].m(r,null),p(r,d),p(r,l),i[9](l),X(l,i[3]),p(r,a),p(r,n),p(r,E),p(e,V),p(e,C),p(C,$);for(let y=0;y<_.length;y+=1)_[y]&&_[y].m($,null);i[11](e),q=!0,H||(c=[U(l,"input",i[10]),U(l,"input",i[5]),U(l,"keydown",i[6]),U(e,"keydown",i[7])],H=!0)},p(u,[h]){let y=o;if(o=B(u),o===y?S[o].p(u,h):(ke(),T(S[y],1,1,()=>{S[y]=null}),ye(),s=S[o],s?s.p(u,h):(s=S[o]=L[o](u),s.c()),I(s,1),s.m(r,d)),h&8&&l.value!==u[3]&&X(l,u[3]),h&17){D=x(u[0]);let f;for(f=0;f<D.length;f+=1){const N=te(u,D,f);_[f]?(_[f].p(N,h),I(_[f],1)):(_[f]=le(N),_[f].c(),I(_[f],1),_[f].m($,null))}for(;f<_.length;f+=1)_[f].d(1);_.length=D.length}},i(u){if(!q){I(s);for(let h=0;h<D.length;h+=1)I(_[h]);q=!0}},o(u){T(s),q=!1},d(u){u&&v(e),S[o].d(),i[9](null),ie(_,u),i[11](null),H=!1,ce(c)}}}function Ne(i,e,t){let r,o;Y(i,we,c=>t(4,r=c)),Y(i,ee,c=>t(13,o=c));let s=o.tables,d=s,l,a,n;(async()=>await De.get())().then(c=>{s=c,t(0,d=c),ue(ee,o.tables=c,o)});const m=fe();ae(async()=>{a.focus(),document.addEventListener("keydown",c=>{c.ctrlKey&&c.key==="k"&&(c.preventDefault(),m("sidebarNeeded"),a.focus(),a.select())}),r.data.table&&l.querySelector(`[href$="${r.data.table.id}"]`).scrollIntoView({behavior:"smooth",block:"center"})});const E=()=>{n?t(0,d=s.filter(c=>c.name.includes(n))):t(0,d=s)},P=c=>{c.key==="Escape"&&(t(3,n=""),E()),c.key==="Enter"&&l.querySelector("li:first-child a").click()},V=c=>{var L,S,B,D,_,u,h,y,f,N;c.key==="ArrowDown"&&l.contains(document.activeElement)&&(c.preventDefault(),document.activeElement.matches("input")?(L=l.querySelector("a"))==null||L.focus():(_=(D=(B=(S=document.activeElement)==null?void 0:S.parentElement)==null?void 0:B.nextElementSibling)==null?void 0:D.querySelector("a"))==null||_.focus()),c.key==="ArrowUp"&&l.contains(document.activeElement)&&(c.preventDefault(),(u=document.activeElement)!=null&&u.matches("li:first-child a")?a.focus():(N=(f=(y=(h=document.activeElement)==null?void 0:h.parentElement)==null?void 0:y.previousElementSibling)==null?void 0:f.querySelector("a"))==null||N.focus()),c.key==="Escape"&&l.contains(document.activeElement)&&(a.focus(),t(3,n=""),E())},C=()=>{t(3,n=null),E()};function $(c){Z[c?"unshift":"push"](()=>{a=c,t(2,a)})}function q(){n=this.value,t(3,n)}function H(c){Z[c?"unshift":"push"](()=>{l=c,t(1,l)})}return[d,l,a,n,r,E,P,V,C,$,q,H]}class qe extends ne{constructor(e){super(),re(this,e,Ne,$e,se,{})}}function Ae(i){let e,t,r,o,s;r=new qe({}),r.$on("sidebarNeeded",i[3]);const d=i[2].default,l=pe(d,i,i[1],null);return{c(){e=g("div"),t=g("div"),O(r.$$.fragment),o=A(),l&&l.c(),this.h()},l(a){e=k(a,"DIV",{class:!0});var n=w(e);t=k(n,"DIV",{class:!0});var m=w(t);R(r.$$.fragment,m),m.forEach(v),o=K(n),l&&l.l(n),n.forEach(v),this.h()},h(){b(t,"class","tables-container svelte-s8xmdg"),b(e,"class","container svelte-s8xmdg"),z(e,"tablesHidden",i[0])},m(a,n){j(a,e,n),p(e,t),J(r,t,null),p(e,o),l&&l.m(e,null),s=!0},p(a,[n]){l&&l.p&&(!s||n&2)&&be(l,d,a,a[1],s?ge(d,a[1],n,null):ve(a[1]),null),(!s||n&1)&&z(e,"tablesHidden",a[0])},i(a){s||(I(r.$$.fragment,a),I(l,a),s=!0)},o(a){T(r.$$.fragment,a),T(l,a),s=!1},d(a){a&&v(e),Q(r),l&&l.d(a)}}}function Ke(i,e,t){let{$$slots:r={},$$scope:o}=e,s=!1;ae(()=>{document.addEventListener("keydown",l=>{!l.target.matches("input, textarea")&&l.key==="b"&&(t(0,s=!s),localStorage.tablesHidden=s)})});const d=()=>t(0,s=!1);return i.$$set=l=>{"$$scope"in l&&t(1,o=l.$$scope)},[s,o,r,d]}class ze extends ne{constructor(e){super(),re(this,e,Ke,Ae,se,{})}}export{ze as component};
