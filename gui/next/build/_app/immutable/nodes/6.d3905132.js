import{Q as U,R as W,S as A,T as X,s as Z,D as $,a as w,f as p,J as x,d as _,c as T,g as m,h as g,j as v,i as L,u as i,E as tt,F as et,G as st,v as q,o as lt,p as at,A as b,r as rt,N as ot,l as j,m as I,w as ct,z as nt}from"../chunks/scheduler.bed694a1.js";import{g as ut,t as Q,c as ht,a as Y,S as dt,i as it}from"../chunks/index.606d5641.js";import{e as F}from"../chunks/each.177d9825.js";import{p as _t}from"../chunks/stores.f5c00c65.js";import{s as G}from"../chunks/state.88bbaa31.js";function ft(s,t){const a=t.token={};function c(h,u,n,r){if(t.token!==a)return;t.resolved=r;let e=t.ctx;n!==void 0&&(e=e.slice(),e[n]=r);const o=h&&(t.current=h)(e);let l=!1;t.block&&(t.blocks?t.blocks.forEach((d,f)=>{f!==u&&d&&(ut(),Q(d,1,1,()=>{t.blocks[f]===d&&(t.blocks[f]=null)}),ht())}):t.block.d(1),o.c(),Y(o,1),o.m(t.mount(),t.anchor),l=!0),t.block=o,t.blocks&&(t.blocks[u]=o),l&&X()}if(U(s)){const h=W();if(s.then(u=>{A(h),c(t.then,1,t.value,u),A(null)},u=>{if(A(h),c(t.catch,2,t.error,u),A(null),!t.hasCatch)throw u}),t.current!==t.pending)return c(t.pending,0),!0}else{if(t.current!==t.then)return c(t.then,1,t.value,s),!0;t.resolved=s}}function pt(s,t,a){const c=t.slice(),{resolved:h}=s;s.current===s.then&&(c[s.value]=h),s.current===s.catch&&(c[s.error]=h),s.block.p(c,a)}const K={get:async s=>{const t=typeof window<"u"&&window.location.port!=="4173"&&window.location.port!=="5173"?`http://localhost:${parseInt(window.location.port)-1}/api/logsv2`:"http://localhost:3333/api/logsv2";return fetch(t).then(a=>a.ok?a.json():Promise.reject(a)).then(a=>a).catch(a=>({error:a}))}};function J(s,t,a){const c=s.slice();return c[8]=t[a],c}function mt(s){return{c:b,l:b,m:b,p:b,d:b}}function vt(s){let t,a,c='<tr><th class="svelte-8d8f5u">Time</th> <th class="svelte-8d8f5u">Type</th> <th class="message svelte-8d8f5u">Message</th></tr>',h,u,n=F(s[7].body.hits),r=[];for(let e=0;e<n.length;e+=1)r[e]=P(J(s,n,e));return{c(){t=p("table"),a=p("thead"),a.innerHTML=c,h=w(),u=p("tbody");for(let e=0;e<r.length;e+=1)r[e].c();this.h()},l(e){t=m(e,"TABLE",{class:!0});var o=g(t);a=m(o,"THEAD",{"data-svelte-h":!0}),rt(a)!=="svelte-1hz51lg"&&(a.innerHTML=c),h=T(o),u=m(o,"TBODY",{});var l=g(u);for(let d=0;d<r.length;d+=1)r[d].l(l);l.forEach(_),o.forEach(_),this.h()},h(){v(t,"class","svelte-8d8f5u")},m(e,o){L(e,t,o),i(t,a),i(t,h),i(t,u);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(u,null)},p(e,o){if(o&0){n=F(e[7].body.hits);let l;for(l=0;l<n.length;l+=1){const d=J(e,n,l);r[l]?r[l].p(d,o):(r[l]=P(d),r[l].c(),r[l].m(u,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},d(e){e&&_(t),ot(r,e)}}}function P(s){let t,a,c,h=new Date(s[8].options_at/1e3).toLocaleString()+"",u,n,r,e,o=s[8].type+"",l,d,f,y,E,M=s[8].message+"",S,C;return{c(){t=p("tr"),a=p("td"),c=p("a"),u=j(h),n=w(),r=p("td"),e=p("a"),l=j(o),d=w(),f=p("td"),y=p("a"),E=p("div"),S=j(M),C=w(),this.h()},l(D){t=m(D,"TR",{class:!0});var k=g(t);a=m(k,"TD",{class:!0});var H=g(a);c=m(H,"A",{href:!0});var O=g(c);u=I(O,h),O.forEach(_),H.forEach(_),n=T(k),r=m(k,"TD",{class:!0});var z=g(r);e=m(z,"A",{href:!0});var B=g(e);l=I(B,o),B.forEach(_),z.forEach(_),d=T(k),f=m(k,"TD",{class:!0});var N=g(f);y=m(N,"A",{href:!0,class:!0});var R=g(y);E=m(R,"DIV",{class:!0});var V=g(E);S=I(V,M),V.forEach(_),R.forEach(_),N.forEach(_),C=T(k),k.forEach(_),this.h()},h(){v(c,"href","/logsv2/"+s[8]._timestamp),v(a,"class","time svelte-8d8f5u"),v(e,"href","/logsv2/"+s[8]._timestamp),v(r,"class","type svelte-8d8f5u"),v(E,"class","svelte-8d8f5u"),v(y,"href","/logsv2/"+s[8]._timestamp),v(y,"class","svelte-8d8f5u"),v(f,"class","message svelte-8d8f5u"),v(t,"class","svelte-8d8f5u"),ct(t,"error",s[8].type.match(/error/i))},m(D,k){L(D,t,k),i(t,a),i(a,c),i(c,u),i(t,n),i(t,r),i(r,e),i(e,l),i(t,d),i(t,f),i(f,y),i(y,E),i(E,S),i(t,C)},p:b,d(D){D&&_(t)}}}function gt(s){return{c:b,l:b,m:b,p:b,d:b}}function bt(s){let t,a,c,h,u,n={ctx:s,current:null,token:null,hasCatch:!1,pending:gt,then:vt,catch:mt,value:7};ft(K.get(),n);const r=s[4].default,e=$(r,s,s[3],null);return{c(){t=w(),a=p("div"),c=p("section"),n.block.c(),h=w(),e&&e.c(),this.h()},l(o){x("svelte-1xj5d21",document.head).forEach(_),t=T(o),a=m(o,"DIV",{class:!0});var d=g(a);c=m(d,"SECTION",{class:!0});var f=g(c);n.block.l(f),f.forEach(_),h=T(d),e&&e.l(d),d.forEach(_),this.h()},h(){document.title="Logs | platformOS",v(c,"class","logs svelte-8d8f5u"),v(a,"class","container svelte-8d8f5u")},m(o,l){L(o,t,l),L(o,a,l),i(a,c),n.block.m(c,n.anchor=null),n.mount=()=>c,n.anchor=null,i(a,h),e&&e.m(a,null),s[5](a),u=!0},p(o,[l]){s=o,pt(n,s,l),e&&e.p&&(!u||l&8)&&tt(e,r,s,s[3],u?st(r,s[3],l,null):et(s[3]),null)},i(o){u||(Y(e,o),u=!0)},o(o){Q(e,o),u=!1},d(o){o&&(_(t),_(a)),n.block.d(),n.token=null,n=null,e&&e.d(o),s[5](null)}}}function kt(s,t,a){let c,h;q(s,_t,l=>a(2,c=l)),q(s,G,l=>a(6,h=l));let{$$slots:u={},$$scope:n}=t,r,e;lt(async()=>{a(1,e=await K.get())});function o(l){at[l?"unshift":"push"](()=>{r=l,a(0,r)})}return s.$$set=l=>{"$$scope"in l&&a(3,n=l.$$scope)},s.$$.update=()=>{s.$$.dirty&6&&c.params.id&&(nt(G,h.logv2=e==null?void 0:e.body.hits.find(l=>l._timestamp==c.params.id),h),console.log(e==null?void 0:e.body.hits))},[r,e,c,n,u,o]}class At extends dt{constructor(t){super(),it(this,t,kt,bt,Z,{})}}export{At as component};
