import{s as ae,e as v,a as Z,c as b,b as L,g as G,z as U,f as g,y as h,E as I,i as T,h as k,B as ne,p as ie,Z as ce,k as Y,t as O,v as x,d as B,j as F,n as ee,C as te}from"../chunks/scheduler.CatAnzbk.js";import{S as oe,i as re,c as N,b as q,m as z,t as $,a as C,e as A,g as H,d as V}from"../chunks/index.N6gnbVk9.js";import{p as fe}from"../chunks/stores.1wDFbM4f.js";import{l as ue}from"../chunks/logsv2.jKOCppqP.js";import{s as J}from"../chunks/state.5gKcL4gY.js";import{t as me}from"../chunks/tryParseJSON.KtkvGy73.js";import{A as pe}from"../chunks/Aside.Lf2QZhoZ.js";import{J as _e}from"../chunks/JSONTree.bqiAs6Hw.js";import{I as de}from"../chunks/Icon.Y-cxXlAi.js";function ge(r){let e,t,s,l,n="Copy",o,c,a,f;return t=new de({props:{icon:r[0]?"check":r[2]?"x":"copy",size:"16"}}),{c(){e=v("button"),N(t.$$.fragment),s=Z(),l=v("span"),l.textContent=n,this.h()},l(i){e=b(i,"BUTTON",{title:!0,class:!0,"aria-disabled":!0});var _=L(e);q(t.$$.fragment,_),s=G(_),l=b(_,"SPAN",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-uxc2fm"&&(l.textContent=n),_.forEach(g),this.h()},h(){h(l,"class","label"),h(e,"title","Copy message to clipboard"),h(e,"class","button compact svelte-kur7tm"),h(e,"aria-disabled",o=r[1]||r[0]||r[2]),I(e,"progressing",r[1])},m(i,_){T(i,e,_),z(t,e,null),k(e,s),k(e,l),c=!0,a||(f=ne(e,"click",r[3]),a=!0)},p(i,[_]){const w={};_&5&&(w.icon=i[0]?"check":i[2]?"x":"copy"),t.$set(w),(!c||_&7&&o!==(o=i[1]||i[0]||i[2]))&&h(e,"aria-disabled",o),(!c||_&2)&&I(e,"progressing",i[1])},i(i){c||($(t.$$.fragment,i),c=!0)},o(i){C(t.$$.fragment,i),c=!1},d(i){i&&g(e),A(t),a=!1,f()}}}function he(r,e,t){let{text:s}=e,l=!1,n=!1,o=!1;const c=()=>{t(1,n=!0),navigator.clipboard.writeText(s.toString()).then(()=>{setTimeout(()=>{t(0,l=!0)},150),setTimeout(()=>{t(1,n=!1)},300),setTimeout(()=>{t(1,n=!0)},2300),setTimeout(()=>{t(0,l=!1)},2450),setTimeout(()=>{t(1,n=!1)},2600)}).catch(a=>{t(1,n=!1),t(2,o=!0),console.error(a)})};return r.$$set=a=>{"text"in a&&t(4,s=a.text)},[l,n,o,c,s]}class ve extends oe{constructor(e){super(),re(this,e,he,ge,ae,{text:4})}}function M(r){const e=r.slice(),t=me(e[1].logv2.message);return e[3]=t,e}function se(r){let e,t="Message:",s,l,n;return l=new ve({props:{text:r[1].logv2.message}}),{c(){e=v("dt"),e.textContent=t,s=v("dd"),N(l.$$.fragment),this.h()},l(o){e=b(o,"DT",{"data-svelte-h":!0}),U(e)!=="svelte-j9d3r1"&&(e.textContent=t),s=b(o,"DD",{class:!0});var c=L(s);q(l.$$.fragment,c),c.forEach(g),this.h()},h(){h(s,"class","svelte-2gl9bd")},m(o,c){T(o,e,c),T(o,s,c),z(l,s,null),n=!0},p(o,c){const a={};c&2&&(a.text=o[1].logv2.message),l.$set(a)},i(o){n||($(l.$$.fragment,o),n=!0)},o(o){C(l.$$.fragment,o),n=!1},d(o){o&&(g(e),g(s)),A(l)}}}function le(r){let e,t,s,l;const n=[$e,be],o=[];function c(a,f){return a[3]?0:1}return t=c(r),s=o[t]=n[t](r),{c(){e=v("div"),s.c(),this.h()},l(a){e=b(a,"DIV",{class:!0});var f=L(e);s.l(f),f.forEach(g),this.h()},h(){h(e,"class","code svelte-2gl9bd"),I(e,"json",r[3])},m(a,f){T(a,e,f),o[t].m(e,null),l=!0},p(a,f){let i=t;t=c(a),t===i?o[t].p(a,f):(H(),C(o[i],1,1,()=>{o[i]=null}),V(),s=o[t],s?s.p(a,f):(s=o[t]=n[t](a),s.c()),$(s,1),s.m(e,null)),(!l||f&2)&&I(e,"json",a[3])},i(a){l||($(s),l=!0)},o(a){C(s),l=!1},d(a){a&&g(e),o[t].d()}}}function be(r){let e=r[1].logv2.message+"",t;return{c(){t=O(e)},l(s){t=B(s,e)},m(s,l){T(s,t,l)},p(s,l){l&2&&e!==(e=s[1].logv2.message+"")&&F(t,e)},i:ee,o:ee,d(s){s&&g(t)}}}function $e(r){let e,t;return e=new _e({props:{value:r[3],showFullLines:!0}}),{c(){N(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,l){z(e,s,l),t=!0},p(s,l){const n={};l&2&&(n.value=s[3]),e.$set(n)},i(s){t||($(e.$$.fragment,s),t=!0)},o(s){C(e.$$.fragment,s),t=!1},d(s){A(e,s)}}}function ke(r){var K,Q,W;let e,t,s="Time:",l,n=new Date(((K=r[1].logv2)==null?void 0:K.options_at)/1e3).toLocaleString()+"",o,c,a="URL:",f,i,_=new URL("https://"+((Q=r[1].logv2)==null?void 0:Q.options_data_url)).pathname+new URL("https://"+((W=r[1].logv2)==null?void 0:W.options_data_url)).search+"",w,P,R,S,D,m=r[1].logv2.message&&se(r),p=r[1].logv2.message&&le(M(r));return{c(){e=v("dl"),t=v("dt"),t.textContent=s,l=v("dd"),o=O(n),c=v("dt"),c.textContent=a,f=v("dd"),i=v("a"),w=O(_),m&&m.c(),R=Z(),p&&p.c(),S=x(),this.h()},l(u){e=b(u,"DL",{class:!0});var d=L(e);t=b(d,"DT",{"data-svelte-h":!0}),U(t)!=="svelte-toke4h"&&(t.textContent=s),l=b(d,"DD",{class:!0});var y=L(l);o=B(y,n),y.forEach(g),c=b(d,"DT",{"data-svelte-h":!0}),U(c)!=="svelte-vrqyfv"&&(c.textContent=a),f=b(d,"DD",{class:!0});var E=L(f);i=b(E,"A",{href:!0,class:!0});var j=L(i);w=B(j,_),j.forEach(g),E.forEach(g),m&&m.l(d),d.forEach(g),R=G(u),p&&p.l(u),S=x(),this.h()},h(){var u;h(l,"class","svelte-2gl9bd"),h(i,"href",P="https://"+((u=r[1].logv2)==null?void 0:u.options_data_url)),h(i,"class","svelte-2gl9bd"),h(f,"class","svelte-2gl9bd"),h(e,"class","svelte-2gl9bd")},m(u,d){T(u,e,d),k(e,t),k(e,l),k(l,o),k(e,c),k(e,f),k(f,i),k(i,w),m&&m.m(e,null),T(u,R,d),p&&p.m(u,d),T(u,S,d),D=!0},p(u,d){var y,E,j,X;(!D||d&2)&&n!==(n=new Date(((y=u[1].logv2)==null?void 0:y.options_at)/1e3).toLocaleString()+"")&&F(o,n),(!D||d&2)&&_!==(_=new URL("https://"+((E=u[1].logv2)==null?void 0:E.options_data_url)).pathname+new URL("https://"+((j=u[1].logv2)==null?void 0:j.options_data_url)).search+"")&&F(w,_),(!D||d&2&&P!==(P="https://"+((X=u[1].logv2)==null?void 0:X.options_data_url)))&&h(i,"href",P),u[1].logv2.message?m?(m.p(u,d),d&2&&$(m,1)):(m=se(u),m.c(),$(m,1),m.m(e,null)):m&&(H(),C(m,1,1,()=>{m=null}),V()),u[1].logv2.message?p?(p.p(M(u),d),d&2&&$(p,1)):(p=le(M(u)),p.c(),$(p,1),p.m(S.parentNode,S)):p&&(H(),C(p,1,1,()=>{p=null}),V())},i(u){D||($(m),$(p),D=!0)},o(u){C(m),C(p),D=!1},d(u){u&&(g(e),g(R),g(S)),m&&m.d(),p&&p.d(u)}}}function Ce(r){var c;let e,t="",s,l,n,o;return n=new pe({props:{title:((c=r[1].logv2)==null?void 0:c.type)??"Loading…",closeUrl:"/logsv2?"+r[0].url.searchParams.toString(),$$slots:{default:[ke]},$$scope:{ctx:r}}}),{c(){e=v("script"),e.innerHTML=t,l=Z(),N(n.$$.fragment),this.h()},l(a){const f=ie("svelte-1pgpgj4",document.head);e=b(f,"SCRIPT",{src:!0,"data-manual":!0,"data-svelte-h":!0}),U(e)!=="svelte-6mxszl"&&(e.innerHTML=t),f.forEach(g),l=G(a),q(n.$$.fragment,a),this.h()},h(){ce(e.src,s="/prism.js")||h(e,"src",s),h(e,"data-manual","")},m(a,f){k(document.head,e),T(a,l,f),z(n,a,f),o=!0},p(a,[f]){var _;const i={};f&2&&(i.title=((_=a[1].logv2)==null?void 0:_.type)??"Loading…"),f&1&&(i.closeUrl="/logsv2?"+a[0].url.searchParams.toString()),f&18&&(i.$$scope={dirty:f,ctx:a}),n.$set(i)},i(a){o||($(n.$$.fragment,a),o=!0)},o(a){C(n.$$.fragment,a),o=!1},d(a){a&&g(l),g(e),A(n,a)}}}function Te(r,e,t){let s,l;Y(r,fe,o=>t(0,s=o)),Y(r,J,o=>t(1,l=o));const n=async()=>{var c;const o=(c=l.logsv2.hits)==null?void 0:c.find(a=>a._timestamp==s.params.id);if(o)te(J,l.logv2=o,l);else{const a={size:1,sql:`select * from logs where _timestamp = ${s.params.id}`};await ue.get(a).then(f=>{te(J,l.logv2=f.hits[0],l)})}};return r.$$.update=()=>{r.$$.dirty&1&&s.params.id&&n()},[s,l]}class Re extends oe{constructor(e){super(),re(this,e,Te,Ce,ae,{})}}export{Re as component};
