import{s as we,z as de,a as A,e as c,t as Z,p as Ne,f as p,g as M,c as h,b as E,A as _e,d as x,y as r,i as ne,h as n,B as le,C as ce,D as Oe,j as re,r as Re,k as Ie,E as Ue,F as Be,G as Y,l as qe,u as Fe,m as Ke,o as Ve}from"../chunks/scheduler.O37jCfot.js";import{S as je,i as He,b as Ge,c as he,d as pe,m as ge,t as F,a as J,e as Ye,f as ve,g as Je}from"../chunks/index.BD8Tugkl.js";import{e as Pe}from"../chunks/each.HyGgNfjy.js";import{p as Qe}from"../chunks/stores.DT5Ttobb.js";import{l as We}from"../chunks/logsv2.twsCDidx.js";import{s as ke}from"../chunks/state.CoHIB23I.js";import{I as De}from"../chunks/Icon.DjNC8j2O.js";import{N as Xe}from"../chunks/Number.aNPWDAIS.js";function $e(t,s,i){const e=t.slice();return e[18]=s[i],e}function ye(t){let s,i=Pe(t[4].logsv2.hits),e=[];for(let a=0;a<i.length;a+=1)e[a]=Ae($e(t,i,a));return{c(){s=c("tbody");for(let a=0;a<e.length;a+=1)e[a].c()},l(a){s=h(a,"TBODY",{});var m=E(s);for(let l=0;l<e.length;l+=1)e[l].l(m);m.forEach(p)},m(a,m){ne(a,s,m);for(let l=0;l<e.length;l+=1)e[l]&&e[l].m(s,null)},p(a,m){if(m&25){i=Pe(a[4].logsv2.hits);let l;for(l=0;l<i.length;l+=1){const g=$e(a,i,l);e[l]?e[l].p(g,m):(e[l]=Ae(g),e[l].c(),e[l].m(s,null))}for(;l<e.length;l+=1)e[l].d(1);e.length=i.length}},d(a){a&&p(s),Be(e,a)}}}function Ae(t){let s,i,e,a=new Date(t[18].options_at/1e3).toLocaleString()+"",m,l,g,S,v,P=t[18].type+"",k,T,z,C,d,L,w=t[18].message+"",N,D,_;return{c(){s=c("tr"),i=c("td"),e=c("a"),m=Z(a),g=A(),S=c("td"),v=c("a"),k=Z(P),z=A(),C=c("td"),d=c("a"),L=c("div"),N=Z(w),_=A(),this.h()},l(f){s=h(f,"TR",{class:!0});var u=E(s);i=h(u,"TD",{class:!0});var O=E(i);e=h(O,"A",{href:!0,class:!0});var Q=E(e);m=x(Q,a),Q.forEach(p),O.forEach(p),g=M(u),S=h(u,"TD",{class:!0});var K=E(S);v=h(K,"A",{href:!0,class:!0});var V=E(v);k=x(V,P),V.forEach(p),K.forEach(p),z=M(u),C=h(u,"TD",{class:!0});var $=E(C);d=h($,"A",{href:!0,class:!0});var R=E(d);L=h(R,"DIV",{class:!0});var W=E(L);N=x(W,w),W.forEach(p),R.forEach(p),$.forEach(p),_=M(u),u.forEach(p),this.h()},h(){r(e,"href",l="/logsv2/"+t[18]._timestamp+"?"+t[0].url.searchParams.toString()),r(e,"class","svelte-1a8uuza"),r(i,"class","time svelte-1a8uuza"),r(v,"href",T="/logsv2/"+t[18]._timestamp+"?"+t[0].url.searchParams.toString()),r(v,"class","svelte-1a8uuza"),r(S,"class","type svelte-1a8uuza"),r(L,"class","svelte-1a8uuza"),r(d,"href",D="/logsv2/"+t[18]._timestamp+"?"+t[0].url.searchParams.toString()),r(d,"class","svelte-1a8uuza"),r(C,"class","message svelte-1a8uuza"),r(s,"class","svelte-1a8uuza"),Y(s,"error",t[18].type.match(/error/i)),Y(s,"highlight",t[3].key==t[18]._timestamp),Y(s,"active",t[0].params.id==t[18]._timestamp)},m(f,u){ne(f,s,u),n(s,i),n(i,e),n(e,m),n(s,g),n(s,S),n(S,v),n(v,k),n(s,z),n(s,C),n(C,d),n(d,L),n(L,N),n(s,_)},p(f,u){u&16&&a!==(a=new Date(f[18].options_at/1e3).toLocaleString()+"")&&re(m,a),u&17&&l!==(l="/logsv2/"+f[18]._timestamp+"?"+f[0].url.searchParams.toString())&&r(e,"href",l),u&16&&P!==(P=f[18].type+"")&&re(k,P),u&17&&T!==(T="/logsv2/"+f[18]._timestamp+"?"+f[0].url.searchParams.toString())&&r(v,"href",T),u&16&&w!==(w=f[18].message+"")&&re(N,w),u&17&&D!==(D="/logsv2/"+f[18]._timestamp+"?"+f[0].url.searchParams.toString())&&r(d,"href",D),u&16&&Y(s,"error",f[18].type.match(/error/i)),u&24&&Y(s,"highlight",f[3].key==f[18]._timestamp),u&17&&Y(s,"active",f[0].params.id==f[18]._timestamp)},d(f){f&&p(s)}}}function Me(t){let s;const i=t[8].default,e=qe(i,t,t[7],null);return{c(){e&&e.c()},l(a){e&&e.l(a)},m(a,m){e&&e.m(a,m),s=!0},p(a,m){e&&e.p&&(!s||m&128)&&Fe(e,i,a,a[7],s?Ve(i,a[7],m,null):Ke(a[7]),null)},i(a){s||(F(e,a),s=!0)},o(a){J(e,a),s=!1},d(a){e&&e.d(a)}}}function Ze(t){var ze;let s,i,e,a,m,l,g,S,v,P,k,T,z,C,d,L,w="Filter logs",N,D,_,f,u,O,Q='<tr class="svelte-1a8uuza"><th class="svelte-1a8uuza">Time</th> <th class="svelte-1a8uuza">Type</th> <th class="message svelte-1a8uuza">Message</th></tr>',K,V,$,R,W="Page:",oe,U,ie,ue,X=(Math.ceil(t[4].logsv2.total/t[4].logsv2.size)||1)+"",ee,fe,j,me,be;document.title=s="Logs"+((ze=t[4].online)!=null&&ze.MPKIT_URL?": "+t[4].online.MPKIT_URL.replace("https://",""):""),k=new De({props:{icon:"search"}}),D=new De({props:{icon:"arrowRight"}});let I=t[4].logsv2.hits&&ye(t);function Ce(o){t[13](o)}let Ee={form:"filters",name:"page",min:1,max:Math.ceil(t[4].logsv2.total/t[4].logsv2.size)||20,step:1,decreaseLabel:"Previous page",increaseLabel:"Next page",style:"navigation"};t[3].page!==void 0&&(Ee.value=t[3].page),U=new Xe({props:Ee}),de.push(()=>Ge(U,"value",Ce)),U.$on("input",t[14]);let b=t[0].params.id&&Me(t);return{c(){i=A(),e=c("div"),a=c("section"),m=c("nav"),l=c("form"),g=c("input"),S=A(),v=c("fieldset"),P=c("label"),he(k.$$.fragment),T=A(),z=c("input"),C=A(),d=c("button"),L=c("span"),L.textContent=w,N=A(),he(D.$$.fragment),_=A(),f=c("article"),u=c("table"),O=c("thead"),O.innerHTML=Q,K=A(),I&&I.c(),V=A(),$=c("nav"),R=c("label"),R.textContent=W,oe=A(),he(U.$$.fragment),ue=Z(`\r
        of `),ee=Z(X),fe=A(),b&&b.c(),this.h()},l(o){Ne("svelte-dfdkqr",document.head).forEach(p),i=M(o),e=h(o,"DIV",{class:!0});var q=E(e);a=h(q,"SECTION",{class:!0});var B=E(a);m=h(B,"NAV",{class:!0});var Te=E(m);l=h(Te,"FORM",{action:!0,id:!0,class:!0});var te=E(l);g=h(te,"INPUT",{type:!0,name:!0,min:!0,max:!0,class:!0}),S=M(te),v=h(te,"FIELDSET",{class:!0});var H=E(v);P=h(H,"LABEL",{for:!0,class:!0});var Se=E(P);pe(k.$$.fragment,Se),Se.forEach(p),T=M(H),z=h(H,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,class:!0}),C=M(H),d=h(H,"BUTTON",{type:!0,class:!0});var ae=E(d);L=h(ae,"SPAN",{class:!0,"data-svelte-h":!0}),_e(L)!=="svelte-y4mewk"&&(L.textContent=w),N=M(ae),pe(D.$$.fragment,ae),ae.forEach(p),H.forEach(p),te.forEach(p),Te.forEach(p),_=M(B),f=h(B,"ARTICLE",{class:!0});var Le=E(f);u=h(Le,"TABLE",{class:!0});var se=E(u);O=h(se,"THEAD",{class:!0,"data-svelte-h":!0}),_e(O)!=="svelte-uyatsk"&&(O.innerHTML=Q),K=M(se),I&&I.l(se),se.forEach(p),Le.forEach(p),V=M(B),$=h(B,"NAV",{class:!0});var G=E($);R=h(G,"LABEL",{for:!0,"data-svelte-h":!0}),_e(R)!=="svelte-1xadase"&&(R.textContent=W),oe=M(G),pe(U.$$.fragment,G),ue=x(G,`\r
        of `),ee=x(G,X),G.forEach(p),B.forEach(p),fe=M(q),b&&b.l(q),q.forEach(p),this.h()},h(){r(g,"type","date"),r(g,"name","start_time"),r(g,"min",t[6].toISOString().split("T")[0]),r(g,"max",t[5].toISOString().split("T")[0]),r(g,"class","svelte-1a8uuza"),r(P,"for","filter_message"),r(P,"class","svelte-1a8uuza"),r(z,"type","text"),r(z,"name","message"),r(z,"id","filter_message"),r(z,"placeholder","Find logs"),r(z,"class","svelte-1a8uuza"),r(L,"class","label"),r(d,"type","submit"),r(d,"class","button svelte-1a8uuza"),r(v,"class","search svelte-1a8uuza"),r(l,"action",""),r(l,"id","filters"),r(l,"class","svelte-1a8uuza"),r(m,"class","filters svelte-1a8uuza"),r(O,"class","svelte-1a8uuza"),r(u,"class","svelte-1a8uuza"),r(f,"class","content svelte-1a8uuza"),r(R,"for","page"),r($,"class","pagination svelte-1a8uuza"),r(a,"class","container svelte-1a8uuza"),r(e,"class","page svelte-1a8uuza")},m(o,y){ne(o,i,y),ne(o,e,y),n(e,a),n(a,m),n(m,l),n(l,g),le(g,t[3].start_time),n(l,S),n(l,v),n(v,P),ge(k,P,null),n(v,T),n(v,z),le(z,t[3].message),n(v,C),n(v,d),n(d,L),n(d,N),ge(D,d,null),t[12](l),n(a,_),n(a,f),n(f,u),n(u,O),n(u,K),I&&I.m(u,null),n(a,V),n(a,$),n($,R),n($,oe),ge(U,$,null),n($,ue),n($,ee),n(e,fe),b&&b.m(e,null),t[15](e),j=!0,me||(be=[ce(g,"input",t[9]),ce(g,"input",t[10]),ce(z,"input",t[11])],me=!0)},p(o,[y]){var B;(!j||y&16)&&s!==(s="Logs"+((B=o[4].online)!=null&&B.MPKIT_URL?": "+o[4].online.MPKIT_URL.replace("https://",""):""))&&(document.title=s),y&8&&le(g,o[3].start_time),y&8&&z.value!==o[3].message&&le(z,o[3].message),o[4].logsv2.hits?I?I.p(o,y):(I=ye(o),I.c(),I.m(u,null)):I&&(I.d(1),I=null);const q={};y&16&&(q.max=Math.ceil(o[4].logsv2.total/o[4].logsv2.size)||20),!ie&&y&8&&(ie=!0,q.value=o[3].page,Oe(()=>ie=!1)),U.$set(q),(!j||y&16)&&X!==(X=(Math.ceil(o[4].logsv2.total/o[4].logsv2.size)||1)+"")&&re(ee,X),o[0].params.id?b?(b.p(o,y),y&1&&F(b,1)):(b=Me(o),b.c(),F(b,1),b.m(e,null)):b&&(Je(),J(b,1,1,()=>{b=null}),Ye())},i(o){j||(F(k.$$.fragment,o),F(D.$$.fragment,o),F(U.$$.fragment,o),F(b),j=!0)},o(o){J(k.$$.fragment,o),J(D.$$.fragment,o),J(U.$$.fragment,o),J(b),j=!1},d(o){o&&(p(i),p(e)),ve(k),ve(D),t[12](null),I&&I.d(),ve(U),b&&b.d(),t[15](null),me=!1,Re(be)}}}function xe(t,s,i){let e,a;Ie(t,ke,_=>i(4,e=_)),Ie(t,Qe,_=>i(0,a=_));let{$$slots:m={},$$scope:l}=s,g,S;const v=new Date,P=1e3*60*60*24,k=new Date(v-P*3);let T={page:1,start_time:v.toISOString().split("T")[0],...Object.fromEntries(a.url.searchParams)};function z(){T.start_time=this.value,i(3,T)}const C=()=>S.requestSubmit();function d(){T.message=this.value,i(3,T)}function L(_){de[_?"unshift":"push"](()=>{S=_,i(2,S)})}function w(_){t.$$.not_equal(T.page,_)&&(T.page=_,i(3,T))}const N=()=>{S.requestSubmit()};function D(_){de[_?"unshift":"push"](()=>{g=_,i(1,g)})}return t.$$set=_=>{"$$scope"in _&&i(7,l=_.$$scope)},t.$$.update=()=>{t.$$.dirty&1&&We.get(Object.fromEntries(a.url.searchParams)).then(_=>Ue(ke,e.logsv2=_,e))},[a,g,S,T,e,v,k,l,m,z,C,d,L,w,N,D]}class it extends je{constructor(s){super(),He(this,s,xe,Ze,we,{})}}export{it as component};
