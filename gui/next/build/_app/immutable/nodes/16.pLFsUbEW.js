import{s as V,f as b,a as z,g as y,h as E,c as A,r as L,d,j as v,u as j,i as T,v as $,x as Y,J as Z,Q as x,w as ee,l as P,e as F,m as N,n as q,z as Q}from"../chunks/scheduler.sKKhyktU.js";import{S as G,i as K,b as H,d as I,m as J,a as w,t as S,e as M,g as W,c as X}from"../chunks/index.LYVpS7Hw.js";import{p as te}from"../chunks/stores.Ys20x7C0.js";import{l as se}from"../chunks/logsv2.nFauhauf.js";import{t as ae}from"../chunks/tryParseJSON.KtkvGy73.js";import{A as le}from"../chunks/Aside.Na6AmxZs.js";import{J as re}from"../chunks/JSONTree.k3p57Rl8.js";import{I as oe}from"../chunks/Icon.rkznIECp.js";function ne(o){let e,s,a,r,l="Copy",i,t,c,h;return s=new oe({props:{icon:o[0]?"check":o[2]?"x":"copy",size:"16"}}),{c(){e=b("button"),H(s.$$.fragment),a=z(),r=b("span"),r.textContent=l,this.h()},l(n){e=y(n,"BUTTON",{title:!0,class:!0,"aria-disabled":!0});var p=E(e);I(s.$$.fragment,p),a=A(p),r=y(p,"SPAN",{class:!0,"data-svelte-h":!0}),L(r)!=="svelte-uxc2fm"&&(r.textContent=l),p.forEach(d),this.h()},h(){v(r,"class","label"),v(e,"title","Copy message to clipboard"),v(e,"class","button compact svelte-1ve7fyv"),v(e,"aria-disabled",i=o[1]||o[0]||o[2]),j(e,"progressing",o[1])},m(n,p){T(n,e,p),J(s,e,null),$(e,a),$(e,r),t=!0,c||(h=Y(e,"click",o[3]),c=!0)},p(n,[p]){const u={};p&5&&(u.icon=n[0]?"check":n[2]?"x":"copy"),s.$set(u),(!t||p&7&&i!==(i=n[1]||n[0]||n[2]))&&v(e,"aria-disabled",i),(!t||p&2)&&j(e,"progressing",n[1])},i(n){t||(w(s.$$.fragment,n),t=!0)},o(n){S(s.$$.fragment,n),t=!1},d(n){n&&d(e),M(s),c=!1,h()}}}function ie(o,e,s){let{text:a}=e,r=!1,l=!1,i=!1;const t=()=>{s(1,l=!0),navigator.clipboard.writeText(a.toString()).then(()=>{setTimeout(()=>{s(0,r=!0)},150),setTimeout(()=>{s(1,l=!1)},300),setTimeout(()=>{s(1,l=!0)},2300),setTimeout(()=>{s(0,r=!1)},2450),setTimeout(()=>{s(1,l=!1)},2600)}).catch(c=>{s(1,l=!1),s(2,i=!0),console.error(c)})};return o.$$set=c=>{"text"in c&&s(4,a=c.text)},[r,l,i,t,a]}class ce extends G{constructor(e){super(),K(this,e,ie,ne,V,{text:4})}}function R(o){let e,s,a,r,l,i,t,c;a=new ce({props:{text:o[0].message}});const h=[fe,ue],n=[];function p(u,_){return u[2]?0:1}return i=p(o),t=n[i]=h[i](o),{c(){e=b("h2"),s=P(`Message:\r
      `),H(a.$$.fragment),r=z(),l=b("div"),t.c(),this.h()},l(u){e=y(u,"H2",{class:!0});var _=E(e);s=N(_,`Message:\r
      `),I(a.$$.fragment,_),_.forEach(d),r=A(u),l=y(u,"DIV",{class:!0});var k=E(l);t.l(k),k.forEach(d),this.h()},h(){v(e,"class","svelte-14ly6in"),v(l,"class","code svelte-14ly6in"),j(l,"json",o[2])},m(u,_){T(u,e,_),$(e,s),J(a,e,null),T(u,r,_),T(u,l,_),n[i].m(l,null),c=!0},p(u,_){const k={};_&1&&(k.text=u[0].message),a.$set(k);let C=i;i=p(u),i===C?n[i].p(u,_):(W(),S(n[C],1,1,()=>{n[C]=null}),X(),t=n[i],t?t.p(u,_):(t=n[i]=h[i](u),t.c()),w(t,1),t.m(l,null)),(!c||_&4)&&j(l,"json",u[2])},i(u){c||(w(a.$$.fragment,u),w(t),c=!0)},o(u){S(a.$$.fragment,u),S(t),c=!1},d(u){u&&(d(e),d(r),d(l)),M(a),n[i].d()}}}function ue(o){let e=o[0].message+"",s;return{c(){s=P(e)},l(a){s=N(a,e)},m(a,r){T(a,s,r)},p(a,r){r&1&&e!==(e=a[0].message+"")&&q(s,e)},i:Q,o:Q,d(a){a&&d(s)}}}function fe(o){let e,s;return e=new re({props:{value:o[2],showFullLines:!0}}),{c(){H(e.$$.fragment)},l(a){I(e.$$.fragment,a)},m(a,r){J(e,a,r),s=!0},p(a,r){const l={};r&4&&(l.value=a[2]),e.$set(l)},i(a){s||(w(e.$$.fragment,a),s=!0)},o(a){S(e.$$.fragment,a),s=!1},d(a){M(e,a)}}}function me(o){let e,s,a="Time:",r,l=new Date(o[0]?.options_at/1e3).toLocaleString()+"",i,t,c="Host:",h,n,p=o[0]?.options_data_url+"",u,_,k,C,D,f=o[0]?.message&&R(o);return{c(){e=b("dl"),s=b("dt"),s.textContent=a,r=b("dd"),i=P(l),t=b("dt"),t.textContent=c,h=b("dd"),n=b("a"),u=P(p),k=z(),f&&f.c(),C=F(),this.h()},l(m){e=y(m,"DL",{class:!0});var g=E(e);s=y(g,"DT",{"data-svelte-h":!0}),L(s)!=="svelte-toke4h"&&(s.textContent=a),r=y(g,"DD",{class:!0});var O=E(r);i=N(O,l),O.forEach(d),t=y(g,"DT",{"data-svelte-h":!0}),L(t)!=="svelte-ylaeay"&&(t.textContent=c),h=y(g,"DD",{class:!0});var U=E(h);n=y(U,"A",{href:!0,class:!0});var B=E(n);u=N(B,p),B.forEach(d),U.forEach(d),g.forEach(d),k=A(m),f&&f.l(m),C=F(),this.h()},h(){v(r,"class","svelte-14ly6in"),v(n,"href",_=o[0]?.options_data_url),v(n,"class","svelte-14ly6in"),v(h,"class","svelte-14ly6in"),v(e,"class","svelte-14ly6in")},m(m,g){T(m,e,g),$(e,s),$(e,r),$(r,i),$(e,t),$(e,h),$(h,n),$(n,u),T(m,k,g),f&&f.m(m,g),T(m,C,g),D=!0},p(m,g){(!D||g&1)&&l!==(l=new Date(m[0]?.options_at/1e3).toLocaleString()+"")&&q(i,l),(!D||g&1)&&p!==(p=m[0]?.options_data_url+"")&&q(u,p),(!D||g&1&&_!==(_=m[0]?.options_data_url))&&v(n,"href",_),m[0]?.message?f?(f.p(m,g),g&1&&w(f,1)):(f=R(m),f.c(),w(f,1),f.m(C.parentNode,C)):f&&(W(),S(f,1,1,()=>{f=null}),X())},i(m){D||(w(f),D=!0)},o(m){S(f),D=!1},d(m){m&&(d(e),d(k),d(C)),f&&f.d(m)}}}function pe(o){let e,s="",a,r,l,i;return l=new le({props:{title:o[0]?.type??"Loading…",closeUrl:"/logsv2?"+o[1].url.searchParams.toString(),$$slots:{default:[me]},$$scope:{ctx:o}}}),{c(){e=b("script"),e.innerHTML=s,r=z(),H(l.$$.fragment),this.h()},l(t){const c=Z("svelte-1pgpgj4",document.head);e=y(c,"SCRIPT",{src:!0,"data-manual":!0,"data-svelte-h":!0}),L(e)!=="svelte-6mxszl"&&(e.innerHTML=s),c.forEach(d),r=A(t),I(l.$$.fragment,t),this.h()},h(){x(e.src,a="/prism.js")||v(e,"src",a),v(e,"data-manual","")},m(t,c){$(document.head,e),T(t,r,c),J(l,t,c),i=!0},p(t,[c]){const h={};c&1&&(h.title=t[0]?.type??"Loading…"),c&2&&(h.closeUrl="/logsv2?"+t[1].url.searchParams.toString()),c&21&&(h.$$scope={dirty:c,ctx:t}),l.$set(h)},i(t){i||(w(l.$$.fragment,t),i=!0)},o(t){S(l.$$.fragment,t),i=!1},d(t){t&&d(r),d(e),M(l,t)}}}function _e(o,e,s){let a,r;ee(o,te,t=>s(1,r=t));let l={};const i=async()=>{const t={size:1,sql:`select * from logs where _timestamp = ${r.params.id}`};await se.get(t).then(c=>{s(0,l=c.hits[0])})};return o.$$.update=()=>{o.$$.dirty&1&&s(2,a=l&&ae(l.message)),o.$$.dirty&2&&r.params.id&&i()},[l,r,a]}class Ce extends G{constructor(e){super(),K(this,e,_e,pe,V,{})}}export{Ce as component};
