import{s as ze,z as Fe,a as A,e as _,t as se,p as He,f as p,g as C,c,b as E,A as ie,d as ae,y as a,i as _e,h as n,B as me,C as ue,D as Ke,j as fe,r as Ve,k as we,E as je,F as Ge,G as Z,l as Ye,u as Je,m as Qe,o as We,H as Xe}from"../chunks/scheduler.ts1nwYMk.js";import{S as Ze,i as xe,b as et,c as de,d as be,m as Ee,t as j,a as x,e as tt,f as Te,g as st}from"../chunks/index.MbwxngTa.js";import{g as at}from"../chunks/globals.D0QH3NT1.js";import{e as ye}from"../chunks/each.CLm8ZDgo.js";import{g as lt}from"../chunks/entry.DYTJR7db.js";import{p as rt}from"../chunks/stores.D3n-8z5b.js";import{l as nt}from"../chunks/logsv2.twsCDidx.js";import{s as Me}from"../chunks/state.HIdUDD3F.js";import{I as Ne}from"../chunks/Icon.Dn_EaQMz.js";import{N as ot}from"../chunks/Number.CAl2R2zF.js";const{document:Se}=at;function Oe(t,l,i){const e=t.slice();return e[16]=l[i],e}function Re(t){let l,i=ye(t[3].logsv2.hits),e=[];for(let s=0;s<i.length;s+=1)e[s]=Ue(Oe(t,i,s));return{c(){l=_("tbody");for(let s=0;s<e.length;s+=1)e[s].c()},l(s){l=c(s,"TBODY",{});var f=E(l);for(let r=0;r<e.length;r+=1)e[r].l(f);f.forEach(p)},m(s,f){_e(s,l,f);for(let r=0;r<e.length;r+=1)e[r]&&e[r].m(l,null)},p(s,f){if(f&13){i=ye(s[3].logsv2.hits);let r;for(r=0;r<i.length;r+=1){const g=Oe(s,i,r);e[r]?e[r].p(g,f):(e[r]=Ue(g),e[r].c(),e[r].m(l,null))}for(;r<e.length;r+=1)e[r].d(1);e.length=i.length}},d(s){s&&p(l),Ge(e,s)}}}function Ue(t){let l,i,e,s=new Date(t[16].options_at/1e3).toLocaleString()+"",f,r,g,w,k,v=t[16].type+"",T,S,y,L,D,d,N=t[16].message+"",P,m,B;return{c(){l=_("tr"),i=_("td"),e=_("a"),f=se(s),g=A(),w=_("td"),k=_("a"),T=se(v),y=A(),L=_("td"),D=_("a"),d=_("div"),P=se(N),B=A(),this.h()},l(h){l=c(h,"TR",{class:!0});var u=E(l);i=c(u,"TD",{class:!0});var G=E(i);e=c(G,"A",{href:!0,class:!0});var F=E(e);f=ae(F,s),F.forEach(p),G.forEach(p),g=C(u),w=c(u,"TD",{class:!0});var M=E(w);k=c(M,"A",{href:!0,class:!0});var O=E(k);T=ae(O,v),O.forEach(p),M.forEach(p),y=C(u),L=c(u,"TD",{class:!0});var ee=E(L);D=c(ee,"A",{href:!0,class:!0});var Y=E(D);d=c(Y,"DIV",{class:!0});var J=E(d);P=ae(J,N),J.forEach(p),Y.forEach(p),ee.forEach(p),B=C(u),u.forEach(p),this.h()},h(){a(e,"href",r="/logsv2/"+t[16]._timestamp+"?"+t[0].url.searchParams.toString()),a(e,"class","svelte-1mrr17l"),a(i,"class","time svelte-1mrr17l"),a(k,"href",S="/logsv2/"+t[16]._timestamp+"?"+t[0].url.searchParams.toString()),a(k,"class","svelte-1mrr17l"),a(w,"class","type svelte-1mrr17l"),a(d,"class","svelte-1mrr17l"),a(D,"href",m="/logsv2/"+t[16]._timestamp+"?"+t[0].url.searchParams.toString()),a(D,"class","svelte-1mrr17l"),a(L,"class","message svelte-1mrr17l"),a(l,"class","svelte-1mrr17l"),Z(l,"error",t[16].type.match(/error/i)),Z(l,"highlight",t[2].key==t[16]._timestamp),Z(l,"active",t[0].params.id==t[16]._timestamp)},m(h,u){_e(h,l,u),n(l,i),n(i,e),n(e,f),n(l,g),n(l,w),n(w,k),n(k,T),n(l,y),n(l,L),n(L,D),n(D,d),n(d,P),n(l,B)},p(h,u){u&8&&s!==(s=new Date(h[16].options_at/1e3).toLocaleString()+"")&&fe(f,s),u&9&&r!==(r="/logsv2/"+h[16]._timestamp+"?"+h[0].url.searchParams.toString())&&a(e,"href",r),u&8&&v!==(v=h[16].type+"")&&fe(T,v),u&9&&S!==(S="/logsv2/"+h[16]._timestamp+"?"+h[0].url.searchParams.toString())&&a(k,"href",S),u&8&&N!==(N=h[16].message+"")&&fe(P,N),u&9&&m!==(m="/logsv2/"+h[16]._timestamp+"?"+h[0].url.searchParams.toString())&&a(D,"href",m),u&8&&Z(l,"error",h[16].type.match(/error/i)),u&12&&Z(l,"highlight",h[2].key==h[16]._timestamp),u&9&&Z(l,"active",h[0].params.id==h[16]._timestamp)},d(h){h&&p(l)}}}function Be(t){let l;const i=t[7].default,e=Ye(i,t,t[6],null);return{c(){e&&e.c()},l(s){e&&e.l(s)},m(s,f){e&&e.m(s,f),l=!0},p(s,f){e&&e.p&&(!l||f&64)&&Je(e,i,s,s[6],l?We(i,s[6],f,null):Qe(s[6]),null)},i(s){l||(j(e,s),l=!0)},o(s){x(e,s),l=!1},d(s){e&&e.d(s)}}}function it(t){var ke;let l,i,e,s,f,r,g,w="Time limit",k,v,T,S,y,L,D,d,N,P,m,B="Filter logs",h,u,G,F,M,O,ee='<tr class="svelte-1mrr17l"><th class="svelte-1mrr17l">Time</th> <th class="svelte-1mrr17l">Type</th> <th class="message svelte-1mrr17l">Message</th></tr>',Y,J,R,K,Le="Page:",ce,U,pe,he,z,te=(Math.ceil(t[3].logsv2.total/t[3].logsv2.size)||1)+"",le,re,ge,V,ve,Pe;Se.title=l="Logs"+((ke=t[3].online)!=null&&ke.MPKIT_URL?": "+t[3].online.MPKIT_URL.replace("https://",""):""),L=new Ne({props:{icon:"search"}}),u=new Ne({props:{icon:"arrowRight"}});let I=t[3].logsv2.hits&&Re(t);function qe(o){t[13](o)}let Ie={form:"filters",name:"page",min:1,max:Math.ceil(t[3].logsv2.total/t[3].logsv2.size)||20,step:1,decreaseLabel:"Previous page",increaseLabel:"Next page",style:"navigation"};t[2].page!==void 0&&(Ie.value=t[2].page),U=new ot({props:Ie}),Fe.push(()=>et(U,"value",qe)),U.$on("input",t[14]);let b=t[0].params.id&&Be(t);return{c(){i=A(),e=_("div"),s=_("section"),f=_("nav"),r=_("form"),g=_("label"),g.textContent=w,k=A(),v=_("input"),T=A(),S=_("fieldset"),y=_("label"),de(L.$$.fragment),D=A(),d=_("input"),N=A(),P=_("button"),m=_("span"),m.textContent=B,h=A(),de(u.$$.fragment),G=A(),F=_("article"),M=_("table"),O=_("thead"),O.innerHTML=ee,Y=A(),I&&I.c(),J=A(),R=_("nav"),K=_("label"),K.textContent=Le,ce=A(),de(U.$$.fragment),he=se(`\r
        of `),z=_("span"),le=se(te),ge=A(),b&&b.c(),this.h()},l(o){He("svelte-dfdkqr",Se.head).forEach(p),i=C(o),e=c(o,"DIV",{class:!0});var H=E(e);s=c(H,"SECTION",{class:!0});var q=E(s);f=c(q,"NAV",{class:!0});var De=E(f);r=c(De,"FORM",{action:!0,id:!0,class:!0});var Q=E(r);g=c(Q,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ie(g)!=="svelte-125i4ut"&&(g.textContent=w),k=C(Q),v=c(Q,"INPUT",{type:!0,name:!0,id:!0,min:!0,max:!0,class:!0}),T=C(Q),S=c(Q,"FIELDSET",{class:!0});var W=E(S);y=c(W,"LABEL",{for:!0,class:!0});var $e=E(y);be(L.$$.fragment,$e),$e.forEach(p),D=C(W),d=c(W,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,class:!0}),N=C(W),P=c(W,"BUTTON",{type:!0,class:!0});var ne=E(P);m=c(ne,"SPAN",{class:!0,"data-svelte-h":!0}),ie(m)!=="svelte-y4mewk"&&(m.textContent=B),h=C(ne),be(u.$$.fragment,ne),ne.forEach(p),W.forEach(p),Q.forEach(p),De.forEach(p),G=C(q),F=c(q,"ARTICLE",{class:!0});var Ae=E(F);M=c(Ae,"TABLE",{class:!0});var oe=E(M);O=c(oe,"THEAD",{class:!0,"data-svelte-h":!0}),ie(O)!=="svelte-uyatsk"&&(O.innerHTML=ee),Y=C(oe),I&&I.l(oe),oe.forEach(p),Ae.forEach(p),J=C(q),R=c(q,"NAV",{class:!0});var X=E(R);K=c(X,"LABEL",{for:!0,"data-svelte-h":!0}),ie(K)!=="svelte-1xadase"&&(K.textContent=Le),ce=C(X),be(U.$$.fragment,X),he=ae(X,`\r
        of `),z=c(X,"SPAN",{class:!0,title:!0});var Ce=E(z);le=ae(Ce,te),Ce.forEach(p),X.forEach(p),q.forEach(p),ge=C(H),b&&b.l(H),H.forEach(p),this.h()},h(){a(g,"for","start_time"),a(g,"class","label svelte-1mrr17l"),a(v,"type","date"),a(v,"name","start_time"),a(v,"id","start_time"),a(v,"min",t[5].toISOString().split("T")[0]),a(v,"max",t[4].toISOString().split("T")[0]),a(v,"class","svelte-1mrr17l"),a(y,"for","filter_message"),a(y,"class","svelte-1mrr17l"),a(d,"type","text"),a(d,"name","message"),a(d,"id","filter_message"),a(d,"placeholder","Find logs"),a(d,"class","svelte-1mrr17l"),a(m,"class","label svelte-1mrr17l"),a(P,"type","submit"),a(P,"class","button svelte-1mrr17l"),a(S,"class","search svelte-1mrr17l"),a(r,"action",""),a(r,"id","filters"),a(r,"class","svelte-1mrr17l"),a(f,"class","filters svelte-1mrr17l"),a(O,"class","svelte-1mrr17l"),a(M,"class","svelte-1mrr17l"),a(F,"class","content svelte-1mrr17l"),a(K,"for","page"),a(z,"class","info svelte-1mrr17l"),a(z,"title",re=t[3].logsv2.total+" logs total"),a(R,"class","pagination svelte-1mrr17l"),a(s,"class","container svelte-1mrr17l"),a(e,"class","page svelte-1mrr17l")},m(o,$){_e(o,i,$),_e(o,e,$),n(e,s),n(s,f),n(f,r),n(r,g),n(r,k),n(r,v),me(v,t[2].start_time),n(r,T),n(r,S),n(S,y),Ee(L,y,null),n(S,D),n(S,d),me(d,t[2].message),n(S,N),n(S,P),n(P,m),n(P,h),Ee(u,P,null),t[11](r),n(s,G),n(s,F),n(F,M),n(M,O),n(M,Y),I&&I.m(M,null),n(s,J),n(s,R),n(R,K),n(R,ce),Ee(U,R,null),n(R,he),n(R,z),n(z,le),n(e,ge),b&&b.m(e,null),V=!0,ve||(Pe=[ue(v,"input",t[8]),ue(v,"input",t[9]),ue(d,"input",t[10]),ue(r,"submit",t[12])],ve=!0)},p(o,[$]){var q;(!V||$&8)&&l!==(l="Logs"+((q=o[3].online)!=null&&q.MPKIT_URL?": "+o[3].online.MPKIT_URL.replace("https://",""):""))&&(Se.title=l),$&4&&me(v,o[2].start_time),$&4&&d.value!==o[2].message&&me(d,o[2].message),o[3].logsv2.hits?I?I.p(o,$):(I=Re(o),I.c(),I.m(M,null)):I&&(I.d(1),I=null);const H={};$&8&&(H.max=Math.ceil(o[3].logsv2.total/o[3].logsv2.size)||20),!pe&&$&4&&(pe=!0,H.value=o[2].page,Ke(()=>pe=!1)),U.$set(H),(!V||$&8)&&te!==(te=(Math.ceil(o[3].logsv2.total/o[3].logsv2.size)||1)+"")&&fe(le,te),(!V||$&8&&re!==(re=o[3].logsv2.total+" logs total"))&&a(z,"title",re),o[0].params.id?b?(b.p(o,$),$&1&&j(b,1)):(b=Be(o),b.c(),j(b,1),b.m(e,null)):b&&(st(),x(b,1,1,()=>{b=null}),tt())},i(o){V||(j(L.$$.fragment,o),j(u.$$.fragment,o),j(U.$$.fragment,o),j(b),V=!0)},o(o){x(L.$$.fragment,o),x(u.$$.fragment,o),x(U.$$.fragment,o),x(b),V=!1},d(o){o&&(p(i),p(e)),Te(L),Te(u),t[11](null),I&&I.d(),Te(U),b&&b.d(),ve=!1,Ve(Pe)}}}function mt(t,l,i){let e,s;we(t,Me,m=>i(3,e=m)),we(t,rt,m=>i(0,s=m));let{$$slots:f={},$$scope:r}=l,g;const w=new Date,k=1e3*60*60*24,v=new Date(w-k*3);let T={page:1,start_time:w.toISOString().split("T")[0],...Object.fromEntries(s.url.searchParams)};function S(){T.start_time=this.value,i(2,T)}const y=()=>g.requestSubmit();function L(){T.message=this.value,i(2,T)}function D(m){Fe[m?"unshift":"push"](()=>{g=m,i(1,g)})}const d=async m=>{var B;((B=m.submitter)==null?void 0:B.dataset.action)!=="numberIncrease"&&(m.preventDefault(),i(2,T.page=1,T),await Xe(),lt(document.location.pathname+"?"+new URLSearchParams(new FormData(m.target)).toString()))};function N(m){t.$$.not_equal(T.page,m)&&(T.page=m,i(2,T))}const P=m=>{g.requestSubmit(m.detail.submitter)};return t.$$set=m=>{"$$scope"in m&&i(6,r=m.$$scope)},t.$$.update=()=>{t.$$.dirty&1&&nt.get(Object.fromEntries(s.url.searchParams)).then(m=>je(Me,e.logsv2=m,e))},[s,g,T,e,w,v,r,f,S,y,L,D,d,N,P]}class Et extends Ze{constructor(l){super(),xe(this,l,mt,it,ze,{})}}export{Et as component};
